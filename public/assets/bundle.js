var bt=Object.create;var Ee=Object.defineProperty;var vt=Object.getOwnPropertyDescriptor;var Et=Object.getOwnPropertyNames;var _t=Object.getPrototypeOf,xt=Object.prototype.hasOwnProperty;var M=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Tt=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Et(t))!xt.call(e,n)&&n!==r&&Ee(e,n,{get:()=>t[n],enumerable:!(o=vt(t,n))||o.enumerable});return e};var Y=(e,t,r)=>(r=e!=null?bt(_t(e)):{},Tt(t||!e||!e.__esModule?Ee(r,"default",{value:e,enumerable:!0}):r,e));var Re=M((Pr,Be)=>{Be.exports=function(t){return t!=null&&t.constructor!=null&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)}});var Me=M((Mr,Pe)=>{function v(e,t){typeof t=="boolean"&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}Pe.exports=v;v.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};v.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};v.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=new Date().getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.push(e),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var r=this._timeouts.shift();if(r===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1);else return!1;var o=this;return this._timer=setTimeout(function(){o._attempts++,o._operationTimeoutCb&&(o._timeout=setTimeout(function(){o._operationTimeoutCb(o._attempts)},o._operationTimeout),o._options.unref&&o._timeout.unref()),o._fn(o._attempts)},r),this._options.unref&&this._timer.unref(),!0};v.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};v.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)};v.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)};v.prototype.start=v.prototype.try;v.prototype.errors=function(){return this._errors};v.prototype.attempts=function(){return this._attempts};v.prototype.mainError=function(){if(this._errors.length===0)return null;for(var e={},t=null,r=0,o=0;o<this._errors.length;o++){var n=this._errors[o],s=n.message,a=(e[s]||0)+1;e[s]=a,a>=r&&(t=n,r=a)}return t}});var Le=M(R=>{var Ct=Me();R.operation=function(e){var t=R.timeouts(e);return new Ct(t,{forever:e&&(e.forever||e.retries===1/0),unref:e&&e.unref,maxRetryTime:e&&e.maxRetryTime})};R.timeouts=function(e){if(e instanceof Array)return[].concat(e);var t={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var r in e)t[r]=e[r];if(t.minTimeout>t.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var o=[],n=0;n<t.retries;n++)o.push(this.createTimeout(n,t));return e&&e.forever&&!o.length&&o.push(this.createTimeout(n,t)),o.sort(function(s,a){return s-a}),o};R.createTimeout=function(e,t){var r=t.randomize?Math.random()+1:1,o=Math.round(r*Math.max(t.minTimeout,1)*Math.pow(t.factor,e));return o=Math.min(o,t.maxTimeout),o};R.wrap=function(e,t,r){if(t instanceof Array&&(r=t,t=null),!r){r=[];for(var o in e)typeof e[o]=="function"&&r.push(o)}for(var n=0;n<r.length;n++){var s=r[n],a=e[s];e[s]=function(l){var u=R.operation(t),d=Array.prototype.slice.call(arguments,1),p=d.pop();d.push(function(g){u.retry(g)||(g&&(arguments[0]=u.mainError()),p.apply(this,arguments))}),u.attempt(function(){l.apply(e,d)})}.bind(e,a),e[s].options=t}}});var Ae=M((Ir,Ie)=>{Ie.exports=Le()});var Oe=M((Ar,Ne)=>{var St=Ae();function kt(e,t){function r(o,n){var s=t||{},a;"randomize"in s||(s.randomize=!0),a=St.operation(s);function i(d){n(d||new Error("Aborted"))}function l(d,p){if(d.bail){i(d);return}a.retry(d)?s.onRetry&&s.onRetry(d,p):n(a.mainError())}function u(d){var p;try{p=e(i,d)}catch(g){l(g,d);return}Promise.resolve(p).then(o).catch(function(h){l(h,d)})}a.attempt(u)}return new Promise(r)}Ne.exports=kt});var ae=M((Or,$e)=>{function Ut(e,t){if(typeof e!="function")throw new TypeError(`Expected the first argument to be a \`function\`, got \`${typeof e}\`.`);let r,o=0;return function(...s){clearTimeout(r);let a=Date.now(),i=a-o,l=t-i;l<=0?(o=a,e.apply(this,s)):r=setTimeout(()=>{o=Date.now(),e.apply(this,s)},l)}}$e.exports=Ut});var c={errorMessage:null,successMessage:null,loading:null,uploadProgress:null,progressBarFill:null,progressText:null,modalContainer:null,modalContent:null,modalClose:null};function L(){c={errorMessage:document.getElementById("errorMessage"),successMessage:document.getElementById("successMessage"),loading:document.getElementById("loading"),uploadProgress:document.getElementById("uploadProgress"),progressBarFill:document.getElementById("progressBarFill"),progressText:document.getElementById("progressText")},T(c.errorMessage),T(c.successMessage),T(c.loading),T(c.uploadProgress),_e()}function _e(){if(document.getElementById("errorModal")){c.modalContainer=document.getElementById("errorModal"),c.modalContent=document.getElementById("errorModalContent"),c.modalClose=document.getElementById("errorModalClose");return}let e=document.createElement("div");e.id="errorModal",e.className="modal",e.style.display="none",e.style.position="fixed",e.style.zIndex="1000",e.style.left="0",e.style.top="0",e.style.width="100%",e.style.height="100%",e.style.backgroundColor="rgba(0,0,0,0.4)",e.style.overflow="auto";let t=document.createElement("div");t.id="errorModalContent",t.className="modal-content",t.style.backgroundColor="#fefefe",t.style.margin="15% auto",t.style.padding="20px",t.style.border="1px solid #888",t.style.borderRadius="5px",t.style.width="80%",t.style.maxWidth="500px",t.style.boxShadow="0 4px 8px 0 rgba(0,0,0,0.2)";let r=document.createElement("span");r.id="errorModalClose",r.className="close",r.innerHTML="&times;",r.style.color="#aaa",r.style.fontSize="28px",r.style.fontWeight="bold",r.style.cursor="pointer",r.onclick=()=>{e.style.display="none"},t.appendChild(r),e.appendChild(t),document.body.appendChild(e),window.onclick=function(o){o.target===e&&(e.style.display="none")},c.modalContainer=e,c.modalContent=t,c.modalClose=r}function w(e,t=!1){c.errorMessage||L(),e&&e.trim()!==""?(c.errorMessage.textContent=e,Q(c.errorMessage),console.error("[ERROR]",e),t&&xe(e,"error")):T(c.errorMessage),T(c.successMessage)}function Z(e,t=!1){c.successMessage||L(),e&&e.trim()!==""?(c.successMessage.textContent=e,Q(c.successMessage),console.log("[SUCCESS]",e),t&&xe(e,"success")):T(c.successMessage),T(c.errorMessage)}function xe(e,t="error"){for(c.modalContainer||_e();c.modalContent.childElementCount>1;)c.modalContent.removeChild(c.modalContent.lastChild);let r=document.createElement("h3");r.textContent=t==="error"?"\u9519\u8BEF":"\u6210\u529F",r.style.color=t==="error"?"#e74c3c":"#27ae60",r.style.marginTop="0";let o=document.createElement("p");o.textContent=e,o.style.margin="10px 0";let n=document.createElement("button");n.textContent="\u786E\u5B9A",n.style.padding="8px 16px",n.style.backgroundColor=t==="error"?"#e74c3c":"#27ae60",n.style.color="white",n.style.border="none",n.style.borderRadius="4px",n.style.cursor="pointer",n.onclick=()=>{c.modalContainer.style.display="none"},c.modalContent.appendChild(r),c.modalContent.appendChild(o),c.modalContent.appendChild(n),c.modalContainer.style.display="block"}function Te(e,t,r){let o=document.getElementById("resultModal");if(!o)return;let n=document.getElementById("resultLink");n&&(n.value=e);let s=(r/1024).toFixed(1),a=document.querySelector("#resultModal .modal-content h3");a&&(a.textContent=`\u538B\u7F29\u5B8C\u6210 - ${t||"\u538B\u7F29\u5B57\u4F53"}`);let i=document.querySelector("#resultModal .modal-content p");i&&(i.textContent=`\u5B57\u4F53\u538B\u7F29\u5DF2\u5B8C\u6210 (${s}KB)\uFF0C\u60A8\u53EF\u4EE5\uFF1A`),o.style.display="block"}function I(e){c.loading||L(),e?Q(c.loading):T(c.loading)}function Ce(e,t=!0){e&&(e.style.display=t?"block":"none")}function Q(e){Ce(e,!0)}function T(e){Ce(e,!1)}function C(e,t=!0){if(c.uploadProgress||L(),t)Q(c.uploadProgress);else{T(c.uploadProgress);return}let r=Math.max(0,Math.min(100,e));c.progressBarFill.style.width=`${r}%`,c.progressText.textContent=`${Math.round(r)}%`,r>=100?c.progressBarFill.style.backgroundColor="#27ae60":c.progressBarFill.style.backgroundColor="#3498db"}function Se(e,t){let r=window.URL.createObjectURL(e),o=document.createElement("a");o.href=r,o.download=t,document.body.appendChild(o),o.click(),setTimeout(()=>{document.body.removeChild(o),window.URL.revokeObjectURL(r)},100)}function ke(){if(typeof navigator<"u"&&navigator.product==="ReactNative")return!0;if(typeof process<"u"){let e=process.type;return e==="renderer"||e==="worker"?!1:!!(process.versions&&process.versions.node)}return!1}var Ue={toWeb(){throw new Error("Vercel Blob: Sorry, we cannot get a Readable stream in this environment. If you see this message please open an issue here: https://github.com/vercel/storage/ with details on your environment.")}};var Xe=Y(Re(),1),et=Y(Oe(),1);var $=globalThis.fetch.bind(globalThis);var st=Y(ae(),1),ct=Y(ae(),1),Bt=new Promise(e=>{try{let t=new Uint8Array([104,101,108,108,111]);new Blob([t]).text().then(o=>{e(o==="hello")}).catch(()=>{e(!1)})}catch{e(!1)}});async function Je(e){if(e instanceof ReadableStream)return e;if(e instanceof Blob)return e.stream();if(Ge(e))return Ue.toWeb(e);let t;return e instanceof ArrayBuffer?t=new Uint8Array(e):Pt(e)?t=e:t=Rt(e),await Bt?new Blob([t]).stream():new ReadableStream({start(r){r.enqueue(t),r.close()}})}function Ge(e){return typeof e=="object"&&typeof e.pipe=="function"&&e.readable&&typeof e._read=="function"&&typeof e._readableState=="object"}function Rt(e){return new TextEncoder().encode(e)}function Pt(e){return(0,Xe.default)(e)}var Mt=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i,Lt={b:1,kb:1024,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)};function E(e){if(typeof e=="number"&&!isNaN(e))return e;if(typeof e!="string")return null;let t=Mt.exec(e),r,o="b";if(!t)r=parseInt(e,10);else{let[,n,,,s]=t;if(!n)return null;r=parseFloat(n),s&&(o=s.toLowerCase())}return isNaN(r)?null:Math.floor(Lt[o]*r)}function Ke(e){if(e?.token)return e.token;if(process.env.BLOB_READ_WRITE_TOKEN)return process.env.BLOB_READ_WRITE_TOKEN;throw new f("No token found. Either configure the `BLOB_READ_WRITE_TOKEN` environment variable, or pass a `token` option to your calls.")}var f=class extends Error{constructor(e){super(`Vercel Blob: ${e}`)}};function le(e){if(typeof e!="object"||e===null)return!1;let t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}var It=["//"],Ye=(()=>{if(ke())return!0;if(se().startsWith("http://localhost"))return!1;let t=!1,r=new Request(se(),{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!r})();function se(e=""){let t=null;try{t=process.env.VERCEL_BLOB_API_URL||process.env.NEXT_PUBLIC_VERCEL_BLOB_API_URL}catch{}return`${t||"https://blob.vercel-storage.com"}${e}`}var Fe=typeof TextEncoder=="function"?new TextEncoder:null;function Ze(e){return e?typeof e=="string"?Fe?Fe.encode(e).byteLength:new Blob([e]).size:"byteLength"in e&&typeof e.byteLength=="number"?e.byteLength:"size"in e&&typeof e.size=="number"?e.size:0:0}var At=(e,t)=>{let r=new Uint8Array(0);return new TransformStream({transform(o,n){queueMicrotask(()=>{let s=new Uint8Array(r.length+o.byteLength);for(s.set(r),s.set(new Uint8Array(o),r.length),r=s;r.length>=e;){let a=r.slice(0,e);n.enqueue(a),t?.(a.byteLength),r=r.slice(e)}})},flush(o){queueMicrotask(()=>{r.length>0&&(o.enqueue(r),t?.(r.byteLength))})}})};function Qe(e){return globalThis.ReadableStream&&e instanceof ReadableStream}function Nt(e){return!!(Qe(e)||Ge(e))}var Ot=Object.prototype.toString,$t=e=>Ot.call(e)==="[object Error]",Ft=new Set(["network error","Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Load failed","Network request failed","fetch failed","terminated"]);function qt(e){return e&&$t(e)&&e.name==="TypeError"&&typeof e.message=="string"?e.message==="Load failed"?e.stack===void 0:Ft.has(e.message):!1}var tt=!1,qe,He;try{((qe=process.env.DEBUG)!=null&&qe.includes("blob")||(He=process.env.NEXT_PUBLIC_DEBUG)!=null&&He.includes("blob"))&&(tt=!0)}catch{}function b(e,...t){tt&&console.debug(`vercel-blob: ${e}`,...t)}var rt=typeof $=="function",Ht=rt&&Ye,zt=64*1024,ze=async({input:e,init:t,onUploadProgress:r})=>{b("using fetch");let o;if(t.body)if(r){let s=await Je(t.body),a=0,i=At(zt,l=>{a+=l,r(a)});o=s.pipeThrough(i)}else o=t.body;let n=Ye&&o&&Nt(o)?"half":void 0;return $(e,{...t,...t.body?{body:o}:{},duplex:n})},Ve=typeof XMLHttpRequest<"u",De=async({input:e,init:t,onUploadProgress:r})=>{b("using xhr");let o=null;return t.body&&(Qe(t.body)?o=await new Response(t.body).blob():o=t.body),new Promise((n,s)=>{let a=new XMLHttpRequest;if(a.open(t.method||"GET",e.toString(),!0),r&&a.upload.addEventListener("progress",i=>{i.lengthComputable&&r(i.loaded)}),a.onload=()=>{var i;if((i=t.signal)!=null&&i.aborted){s(new DOMException("The user aborted the request.","AbortError"));return}let l=new Headers;a.getAllResponseHeaders().trim().split(/[\r\n]+/).forEach(p=>{let g=p.split(": "),h=g.shift(),_=g.join(": ");h&&l.set(h.toLowerCase(),_)});let d=new Response(a.response,{status:a.status,statusText:a.statusText,headers:l});n(d)},a.onerror=()=>{s(new TypeError("Network request failed"))},a.ontimeout=()=>{s(new TypeError("Network request timed out"))},a.onabort=()=>{s(new DOMException("The user aborted a request.","AbortError"))},t.headers&&new Headers(t.headers).forEach((l,u)=>{a.setRequestHeader(u,l)}),t.signal&&(t.signal.addEventListener("abort",()=>{a.abort()}),t.signal.aborted)){a.abort();return}a.send(o)})},Vt=async({input:e,init:t,onUploadProgress:r})=>{if(r){if(Ht)return ze({input:e,init:t,onUploadProgress:r});if(Ve)return De({input:e,init:t,onUploadProgress:r})}if(rt)return ze({input:e,init:t});if(Ve)return De({input:e,init:t});throw new Error("No request implementation available")},We,Dt=(We=globalThis.DOMException)!=null?We:(()=>{try{atob("~")}catch(e){return Object.getPrototypeOf(e).constructor}})(),je=950,Wt=class extends f{constructor(){super("Access denied, please provide a valid token for this resource.")}},jt=class extends f{constructor(e){super(`Content type mismatch, ${e}.`)}},Xt=class extends f{constructor(e){super(`Pathname mismatch, ${e}. Check the pathname used in upload() or put() matches the one from the client token.`)}},Jt=class extends f{constructor(){super("Client token has expired.")}},Gt=class extends f{constructor(e){super(`File is too large, ${e}.`)}},Kt=class extends f{constructor(){super("This store does not exist.")}},Yt=class extends f{constructor(){super("This store has been suspended.")}},ot=class extends f{constructor(){super("Unknown error, please visit https://vercel.com/help.")}},Zt=class extends f{constructor(){super("The requested blob does not exist")}},te=class extends f{constructor(){super("The blob service is currently not available. Please try again.")}},Qt=class extends f{constructor(e){super(`Too many requests please lower the number of concurrent requests ${e?` - try again in ${e} seconds`:""}.`),this.retryAfter=e??0}},er=class extends f{constructor(){super("The request was aborted.")}},tr=10;function rr(){let e=null;try{e=process.env.VERCEL_BLOB_API_VERSION_OVERRIDE||process.env.NEXT_PUBLIC_VERCEL_BLOB_API_VERSION_OVERRIDE}catch{}return`${e??tr}`}function or(){try{let e=process.env.VERCEL_BLOB_RETRIES||"10";return parseInt(e,10)}catch{return 10}}function nr(e){let t=e.headers.get("retry-after");return new Qt(t?parseInt(t,10):void 0)}async function ar(e){var t,r,o;let n,s;try{let i=await e.json();n=(r=(t=i.error)==null?void 0:t.code)!=null?r:"unknown_error",s=(o=i.error)==null?void 0:o.message}catch{n="unknown_error"}s?.includes("contentType")&&s.includes("is not allowed")&&(n="content_type_not_allowed"),s?.includes('"pathname"')&&s.includes("does not match the token payload")&&(n="client_token_pathname_mismatch"),s==="Token expired"&&(n="client_token_expired"),s?.includes("the file length cannot be greater than")&&(n="file_too_large");let a;switch(n){case"store_suspended":a=new Yt;break;case"forbidden":a=new Wt;break;case"content_type_not_allowed":a=new jt(s);break;case"client_token_pathname_mismatch":a=new Xt(s);break;case"client_token_expired":a=new Jt;break;case"file_too_large":a=new Gt(s);break;case"not_found":a=new Zt;break;case"store_not_found":a=new Kt;break;case"bad_request":a=new f(s??"Bad request");break;case"service_unavailable":a=new te;break;case"rate_limited":a=nr(e);break;case"unknown_error":case"not_allowed":default:a=new ot;break}return{code:n,error:a}}async function re(e,t,r){let o=rr(),n=Ke(r),s=sr(),[,,,a=""]=n.split("_"),i=`${a}:${Date.now()}:${Math.random().toString(16).slice(2)}`,l=0,u=0,d=0,p=r?.onUploadProgress||ir();t.body&&p&&(u=Ze(t.body)),r?.onUploadProgress&&r.onUploadProgress({loaded:0,total:u,percentage:0});let g=await(0,et.default)(async h=>{let _;try{_=await Vt({input:se(e),init:{...t,headers:{"x-api-blob-request-id":i,"x-api-blob-request-attempt":String(l),"x-api-version":o,...p?{"x-content-length":String(u)}:{},authorization:`Bearer ${n}`,...s,...t.headers}},onUploadProgress:r?.onUploadProgress?y=>{var N;let k=u!==0?u:y;d=y;let U=u>0?Number((y/k*100).toFixed(2)):0;U===100&&u>0||(N=r.onUploadProgress)==null||N.call(r,{loaded:y,total:k,percentage:U})}:void 0})}catch(y){if(y instanceof Dt&&y.name==="AbortError"){h(new er);return}if(qt(y))throw y;if(y instanceof TypeError){h(y);return}throw y}if(_.ok)return _;let{code:P,error:S}=await ar(_);if(P==="unknown_error"||P==="service_unavailable"||P==="internal_server_error")throw S;h(S)},{retries:or(),onRetry:h=>{h instanceof Error&&b(`retrying API request to ${e}`,h.message),l=l+1}});if(!g)throw new ot;return r?.onUploadProgress&&r.onUploadProgress({loaded:d,total:d,percentage:100}),await g.json()}function sr(){let e={};try{"VERCEL_BLOB_PROXY_THROUGH_ALTERNATIVE_API"in process.env&&process.env.VERCEL_BLOB_PROXY_THROUGH_ALTERNATIVE_API!==void 0?e["x-proxy-through-alternative-api"]=process.env.VERCEL_BLOB_PROXY_THROUGH_ALTERNATIVE_API:"NEXT_PUBLIC_VERCEL_BLOB_PROXY_THROUGH_ALTERNATIVE_API"in process.env&&process.env.NEXT_PUBLIC_VERCEL_BLOB_PROXY_THROUGH_ALTERNATIVE_API!==void 0&&(e["x-proxy-through-alternative-api"]=process.env.NEXT_PUBLIC_VERCEL_BLOB_PROXY_THROUGH_ALTERNATIVE_API)}catch{}return e}function ir(){try{return process.env.VERCEL_BLOB_USE_X_CONTENT_LENGTH==="1"}catch{return!1}}var ee={cacheControlMaxAge:"x-cache-control-max-age",addRandomSuffix:"x-add-random-suffix",allowOverwrite:"x-allow-overwrite",contentType:"x-content-type"};function q(e,t){let r={};return e.includes("contentType")&&t.contentType&&(r[ee.contentType]=t.contentType),e.includes("addRandomSuffix")&&t.addRandomSuffix!==void 0&&(r[ee.addRandomSuffix]=t.addRandomSuffix?"1":"0"),e.includes("allowOverwrite")&&t.allowOverwrite!==void 0&&(r[ee.allowOverwrite]=t.allowOverwrite?"1":"0"),e.includes("cacheControlMaxAge")&&t.cacheControlMaxAge!==void 0&&(r[ee.cacheControlMaxAge]=t.cacheControlMaxAge.toString()),r}async function H({pathname:e,options:t,extraChecks:r,getToken:o}){if(!e)throw new f("pathname is required");if(e.length>je)throw new f(`pathname is too long, maximum length is ${je}`);for(let n of It)if(e.includes(n))throw new f(`pathname cannot contain "${n}", please encode it if needed`);if(!t)throw new f("missing options, see usage");if(t.access!=="public")throw new f('access must be "public"');return r&&r(t),o&&(t.token=await o(e,t)),t}function nt({allowedOptions:e,getToken:t,extraChecks:r}){return async(o,n,s)=>{let a=await H({pathname:o,options:s,extraChecks:r,getToken:t}),i=q(e,a);return ce({uploadId:a.uploadId,key:a.key,pathname:o,headers:i,options:a,parts:n})}}async function ce({uploadId:e,key:t,pathname:r,parts:o,headers:n,options:s}){let a=new URLSearchParams({pathname:r});try{let i=await re(`/mpu?${a.toString()}`,{method:"POST",headers:{...n,"content-type":"application/json","x-mpu-action":"complete","x-mpu-upload-id":e,"x-mpu-key":encodeURIComponent(t)},body:JSON.stringify(o),signal:s.abortSignal},s);return b("mpu: complete",i),i}catch(i){throw i instanceof TypeError&&(i.message==="Failed to fetch"||i.message==="fetch failed")?new te:i}}function at({allowedOptions:e,getToken:t,extraChecks:r}){return async(o,n)=>{let s=await H({pathname:o,options:n,extraChecks:r,getToken:t}),a=q(e,s),i=await ue(o,a,s);return{key:i.key,uploadId:i.uploadId}}}async function ue(e,t,r){b("mpu: create","pathname:",e);let o=new URLSearchParams({pathname:e});try{let n=await re(`/mpu?${o.toString()}`,{method:"POST",headers:{...t,"x-mpu-action":"create"},signal:r.abortSignal},r);return b("mpu: create",n),n}catch(n){throw n instanceof TypeError&&(n.message==="Failed to fetch"||n.message==="fetch failed")?new te:n}}function it({allowedOptions:e,getToken:t,extraChecks:r}){return async(o,n,s)=>{let a=await H({pathname:o,options:s,extraChecks:r,getToken:t}),i=q(e,a);if(le(n))throw new f("Body must be a string, buffer or stream. You sent a plain JavaScript object, double check what you're trying to upload.");return{etag:(await de({uploadId:a.uploadId,key:a.key,pathname:o,part:{blob:n,partNumber:a.partNumber},headers:i,options:a})).etag,partNumber:a.partNumber}}}async function de({uploadId:e,key:t,pathname:r,headers:o,options:n,internalAbortController:s=new AbortController,part:a}){var i,l,u;let d=new URLSearchParams({pathname:r}),p=re(`/mpu?${d.toString()}`,{signal:s.signal,method:"POST",headers:{...o,"x-mpu-action":"upload","x-mpu-key":encodeURIComponent(t),"x-mpu-upload-id":e,"x-mpu-part-number":a.partNumber.toString()},body:a.blob},n);function g(){s.abort()}(i=n.abortSignal)!=null&&i.aborted?g():(l=n.abortSignal)==null||l.addEventListener("abort",g);let h=await p;return(u=n.abortSignal)==null||u.removeEventListener("abort",g),h}var lt=typeof window<"u"?6:8,ie=8*1024*1024,F=lt*ie*2;function lr({uploadId:e,key:t,pathname:r,stream:o,headers:n,options:s,totalToLoad:a}){b("mpu: upload init","key:",t);let i=new AbortController;return new Promise((l,u)=>{let d=[],p=[],g=o.getReader(),h=0,_=!1,P=1,S=!1,y=0,N=!1,k=0,U=[],X=0,oe,be={};s.onUploadProgress&&(oe=(0,st.default)(()=>{var m;let x=Object.values(be).reduce((G,K)=>G+K,0),B=a||x,O=a>0?Number(((x/a||x)*100).toFixed(2)):0;(m=s.onUploadProgress)==null||m.call(s,{loaded:x,total:B,percentage:O})},150)),ve().catch(J);async function ve(){for(b("mpu: upload read start","activeUploads:",h,"currentBytesInMemory:",`${E(y)}/${E(F)}`,"bytesSent:",E(k)),_=!0;y<F&&!S;)try{let{value:m,done:x}=await g.read();if(x){N=!0,b("mpu: upload read consumed the whole stream"),U.length>0&&(d.push({partNumber:P++,blob:new Blob(U,{type:"application/octet-stream"})}),ne()),_=!1;return}y+=m.byteLength;let B=0;for(;B<m.byteLength;){let O=ie-X,G=Math.min(B+O,m.byteLength),K=m.slice(B,G);U.push(K),X+=K.byteLength,B=G,X===ie&&(d.push({partNumber:P++,blob:new Blob(U,{type:"application/octet-stream"})}),U=[],X=0,ne())}}catch(m){J(m)}b("mpu: upload read end","activeUploads:",h,"currentBytesInMemory:",`${E(y)}/${E(F)}`,"bytesSent:",E(k)),_=!1}async function wt(m){h++,b("mpu: upload send part start","partNumber:",m.partNumber,"size:",m.blob.size,"activeUploads:",h,"currentBytesInMemory:",`${E(y)}/${E(F)}`,"bytesSent:",E(k));try{let x=s.onUploadProgress?O=>{be[m.partNumber]=O.loaded,oe&&oe()}:void 0,B=await de({uploadId:e,key:t,pathname:r,headers:n,options:{...s,onUploadProgress:x},internalAbortController:i,part:m});if(b("mpu: upload send part end","partNumber:",m.partNumber,"activeUploads",h,"currentBytesInMemory:",`${E(y)}/${E(F)}`,"bytesSent:",E(k)),S)return;if(p.push({partNumber:m.partNumber,etag:B.etag}),y-=m.blob.size,h--,k+=m.blob.size,d.length>0&&ne(),N){h===0&&(g.releaseLock(),l(p));return}_||ve().catch(J)}catch(x){J(x)}}function ne(){if(!S)for(b("send parts","activeUploads",h,"partsToUpload",d.length);h<lt&&d.length>0;){let m=d.shift();m&&wt(m)}}function J(m){S||(S=!0,i.abort(),g.releaseLock(),m instanceof TypeError&&(m.message==="Failed to fetch"||m.message==="fetch failed")?u(new te):u(m))}})}async function cr(e,t,r,o){b("mpu: init","pathname:",e,"headers:",r);let n={...o,onUploadProgress:void 0},s=await ue(e,r,n),a=Ze(t),i=await Je(t),l=await lr({uploadId:s.uploadId,key:s.key,pathname:e,stream:i,headers:r,options:o,totalToLoad:a});return await ce({uploadId:s.uploadId,key:s.key,pathname:e,parts:l,headers:r,options:n})}function pe({allowedOptions:e,getToken:t,extraChecks:r}){return async function(n,s,a){if(!s)throw new f("body is required");if(le(s))throw new f("Body must be a string, buffer or stream. You sent a plain JavaScript object, double check what you're trying to upload.");let i=await H({pathname:n,options:a,extraChecks:r,getToken:t}),l=q(e,i);if(i.multipart===!0)return cr(n,s,l,i);let u=i.onUploadProgress?(0,ct.default)(i.onUploadProgress,100):void 0,d=new URLSearchParams({pathname:n}),p=await re(`/?${d.toString()}`,{method:"PUT",body:s,headers:l,signal:i.abortSignal},{...i,onUploadProgress:u});return{url:p.url,downloadUrl:p.downloadUrl,pathname:p.pathname,contentType:p.contentType,contentDisposition:p.contentDisposition}}}function ut({allowedOptions:e,getToken:t,extraChecks:r}){return async(o,n)=>{let s=await H({pathname:o,options:n,extraChecks:r,getToken:t}),a=q(e,s),i=await ue(o,a,s);return{key:i.key,uploadId:i.uploadId,async uploadPart(l,u){if(le(u))throw new f("Body must be a string, buffer or stream. You sent a plain JavaScript object, double check what you're trying to upload.");return{etag:(await de({uploadId:i.uploadId,key:i.key,pathname:o,part:{partNumber:l,blob:u},headers:a,options:s})).etag,partNumber:l}},async complete(l){return ce({uploadId:i.uploadId,key:i.key,pathname:o,parts:l,headers:a,options:s})}}}}function z(e){return function(r){if(!r.token.startsWith("vercel_blob_client_"))throw new f(`${e} must be called with a client token`);if(r.addRandomSuffix!==void 0||r.allowOverwrite!==void 0||r.cacheControlMaxAge!==void 0)throw new f(`${e} doesn't allow \`addRandomSuffix\`, \`cacheControlMaxAge\` or \`allowOverwrite\`. Configure these options at the server side when generating client tokens.`)}}var no=pe({allowedOptions:["contentType"],extraChecks:z("client/`put`")}),ao=at({allowedOptions:["contentType"],extraChecks:z("client/`createMultipartUpload`")}),so=ut({allowedOptions:["contentType"],extraChecks:z("client/`createMultipartUpload`")}),io=it({allowedOptions:["contentType"],extraChecks:z("client/`multipartUpload`")}),lo=nt({allowedOptions:["contentType"],extraChecks:z("client/`completeMultipartUpload`")}),dt=pe({allowedOptions:["contentType"],extraChecks(e){if(e.handleUploadUrl===void 0)throw new f("client/`upload` requires the 'handleUploadUrl' parameter");if(e.addRandomSuffix!==void 0||e.createPutExtraChecks!==void 0||e.cacheControlMaxAge!==void 0)throw new f("client/`upload` doesn't allow `addRandomSuffix`, `cacheControlMaxAge` or `allowOverwrite`. Configure these options at the server side when generating client tokens.")},async getToken(e,t){var r,o;return dr({handleUploadUrl:t.handleUploadUrl,pathname:e,clientPayload:(r=t.clientPayload)!=null?r:null,multipart:(o=t.multipart)!=null?o:!1})}});var ur={generateClientToken:"blob.generate-client-token",uploadCompleted:"blob.upload-completed"};async function dr(e){let{handleUploadUrl:t,pathname:r}=e,o=fr(t)?t:pr(t),n={type:ur.generateClientToken,payload:{pathname:r,callbackUrl:o,clientPayload:e.clientPayload,multipart:e.multipart}},s=await $(o,{method:"POST",body:JSON.stringify(n),headers:{"content-type":"application/json"},signal:e.abortSignal});if(!s.ok)throw new f("Failed to  retrieve the client token");try{let{clientToken:a}=await s.json();return a}catch{throw new f("Failed to retrieve the client token")}}function pr(e){return new URL(e,location.href).href}function fr(e){try{return!!new URL(e)}catch{return!1}}function mr(e,t,r="\u64CD\u4F5C\u8D85\u65F6"){let o,n=new Promise((s,a)=>{o=setTimeout(()=>{a(new Error(r))},t)});return Promise.race([e,n]).finally(()=>{clearTimeout(o)})}function hr(){return window.location.hostname.includes("localhost")?"development":"production"}function yr(e){let t=e.replace(/[^a-zA-Z0-9_.-]/g,"_"),r=Date.now(),o=Math.random().toString(36).substring(2,8),n=t.match(/\.(ttf|otf)$/i),s=n?n[0]:".ttf";return`${n?t.substring(0,t.length-s.length):t}_${r}_${o}${s}`}async function pt(e){try{C(0,!0),console.log(`\u5F00\u59CB\u4E0A\u4F20\u5B57\u4F53: ${e.name} (${(e.size/1024/1024).toFixed(2)}MB)`);let t=hr(),r=yr(e.name),o=dt(`${t}/original/${r}`,e,{access:"public",handleUploadUrl:"/api/upload-font",multipart:!0,onUploadProgress:a=>{let i=a.loaded/a.total*100;C(i)}}),n=Math.min(600,Math.max(60,Math.ceil(e.size/(1024*1024)*10))),s=await mr(o,n*1e3,`\u4E0A\u4F20\u5B57\u4F53\u6587\u4EF6\u8D85\u65F6(${n}\u79D2)`);if(!s||!s.url)throw new Error("\u4E0A\u4F20\u6210\u529F\u4F46\u672A\u83B7\u5F97\u6709\u6548\u7684URL");return C(100),s.url}catch(t){console.error("\u4E0A\u4F20\u5931\u8D25:",t),C(0,!1);let r="\u5B57\u4F53\u4E0A\u4F20\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u6216\u6587\u4EF6\u7C7B\u578B\uFF0C\u7136\u540E\u91CD\u8BD5\u3002";throw t.message&&(t.message.includes("timeout")||t.message.includes("\u8D85\u65F6")?r=`${t.message}\u3002\u5EFA\u8BAE\u4F7F\u7528\u66F4\u597D\u7684\u7F51\u7EDC\u8FDE\u63A5\u6216\u8F83\u5C0F\u6587\u4EF6\u3002`:t.message.includes("network")||t.message.includes("\u7F51\u7EDC")?r="\u7F51\u7EDC\u9519\u8BEF\uFF0C\u8BF7\u68C0\u67E5\u60A8\u7684\u4E92\u8054\u7F51\u8FDE\u63A5\u5E76\u91CD\u8BD5\u3002":r=t.message),w(r,!0),new Error(r)}}function fe(e,t=["font/ttf","font/otf","application/octet-stream","application/vnd.ms-opentype"]){return t.includes(e.type)||/\.(ttf|otf)$/i.test(e.name)}var he={standard:[],combined:[]},gr={standard:"\u6807\u51C6\u5B57\u7B26\u96C6",combined:"\u7EC4\u5408\u5B57\u7B26\u96C6"},wr={digits:"\u6570\u5B57 (0-9)",latin_basic:"\u57FA\u672C\u62C9\u4E01\u5B57\u6BCD (a-z, A-Z)",punctuation_basic:"\u57FA\u672C\u6807\u70B9\u7B26\u53F7",latin:"\u62C9\u4E01\u5B57\u7B26\u96C6",latin_ext:"\u6269\u5C55\u62C9\u4E01\u5B57\u7B26\u96C6",cyrillic:"\u897F\u91CC\u5C14\u5B57\u7B26\u96C6",cyrillic_ext:"\u6269\u5C55\u897F\u91CC\u5C14\u5B57\u7B26\u96C6",greek:"\u5E0C\u814A\u5B57\u7B26\u96C6",greek_ext:"\u6269\u5C55\u5E0C\u814A\u5B57\u7B26\u96C6",vietnamese:"\u8D8A\u5357\u6587\u5B57\u7B26\u96C6",chinese_level1:"\u5E38\u7528\u6C49\u5B57\uFF08\u57FA\u7840\uFF09",chinese_common:"\u5E38\u7528\u6C49\u5B57\uFF08\u6269\u5C55\uFF09",wgl4:"WGL4 \u6CDB\u6B27\u6D32\u5B57\u7B26\u96C6",w1g:"W1G \u4E13\u4E1A\u6392\u7248\u5B57\u7B26\u96C6",math:"\u6570\u5B66\u7B26\u53F7",currency:"\u8D27\u5E01\u7B26\u53F7",arrows:"\u7BAD\u5934\u7B26\u53F7",basic:"\u57FA\u7840\u7EC4\u5408\u5B57\u7B26\u96C6",web_safe:"\u7F51\u9875\u5B89\u5168\u5B57\u7B26\u96C6",european:"\u6B27\u6D32\u8BED\u8A00\u5B57\u7B26\u96C6","pan-european":"\u6CDB\u6B27\u6D32\u5168\u9762\u5B57\u7B26\u96C6",cn:"[\u65E7] \u4E2D\u6587\u6570\u5B57",an:"[\u65E7] \u963F\u62C9\u4F2F\u6570\u5B57",el:"[\u65E7] \u82F1\u6587\u5B57\u6BCD",cp:"[\u65E7] \u4E2D\u6587\u6807\u70B9",ep:"[\u65E7] \u82F1\u6587\u7B26\u53F7",cc:"[\u65E7] \u5E38\u7528\u6C49\u5B57500",cn1000:"[\u65E7] \u5E38\u7528\u6C49\u5B571000+",tech:"[\u65E7] \u6280\u672F\u7B26\u53F7"};async function br(){try{let e=await fetch("/api/get-charsets");if(!e.ok)throw new Error(`\u83B7\u53D6\u5B57\u7B26\u96C6\u5931\u8D25: ${e.status} ${e.statusText}`);let t=await e.json();if(t.success&&t.charsets)return he=t.charsets,t.charsets;throw new Error("\u83B7\u53D6\u5B57\u7B26\u96C6\u4FE1\u606F\u5931\u8D25\uFF0C\u670D\u52A1\u5668\u672A\u8FD4\u56DE\u6709\u6548\u6570\u636E")}catch(e){throw console.error("\u83B7\u53D6\u5B57\u7B26\u96C6\u5931\u8D25:",e),e}}function me(e){return wr[e]||e}async function vr(e){try{let t=await fetch(`/api/get-charsets?name=${encodeURIComponent(e)}`);if(!t.ok)throw new Error(`\u83B7\u53D6\u5B57\u7B26\u96C6\u8BE6\u60C5\u5931\u8D25: ${t.status} ${t.statusText}`);return await t.json()}catch(t){throw console.error(`\u83B7\u53D6\u5B57\u7B26\u96C6 ${e} \u8BE6\u60C5\u5931\u8D25:`,t),t}}async function ft(e){try{let t=document.getElementById(e);if(!t)throw new Error(`\u627E\u4E0D\u5230\u5BB9\u5668\u5143\u7D20: ${e}`);he.standard.length===0&&await br(),t.innerHTML="<h4>\u5B57\u7B26\u96C6\u9009\u62E9\uFF1A</h4>";for(let[r,o]of Object.entries(he)){if(!o||o.length===0)continue;let n=document.createElement("h5");n.textContent=gr[r]||r,n.className="charset-category",t.appendChild(n);let s=document.createElement("div");s.className="preset-options";for(let a of o){let i=document.createElement("div");i.className="checkbox-item";let l=document.createElement("input");l.type="checkbox",l.id=`charset-${a}`,l.className="preset-checkbox",l.setAttribute("data-id",a);let u=document.createElement("label");u.htmlFor=`charset-${a}`,u.textContent=me(a),u.title=`\u70B9\u51FB\u67E5\u770B ${me(a)} \u5305\u542B\u7684\u5B57\u7B26`,u.addEventListener("click",async d=>{d.preventDefault();try{let p=await vr(a);p.success&&p.characters?alert(`${me(a)}
\u5305\u542B ${p.length} \u4E2A\u5B57\u7B26
\u793A\u4F8B: ${p.characters.slice(0,50)}${p.characters.length>50?"...":""}`):alert(`\u65E0\u6CD5\u83B7\u53D6\u5B57\u7B26\u96C6 ${a} \u7684\u8BE6\u7EC6\u4FE1\u606F`)}catch(p){console.error(`\u663E\u793A\u5B57\u7B26\u96C6 ${a} \u8BE6\u60C5\u5931\u8D25:`,p)}setTimeout(()=>{l.checked=!l.checked},100)}),i.appendChild(l),i.appendChild(u),s.appendChild(i)}t.appendChild(s)}}catch(t){console.error("\u751F\u6210\u5B57\u7B26\u96C6\u9009\u62E9\u754C\u9762\u5931\u8D25:",t);let r=document.createElement("div");r.className="error-message",r.textContent="\u52A0\u8F7D\u5B57\u7B26\u96C6\u5931\u8D25\uFF0C\u8BF7\u5237\u65B0\u9875\u9762\u91CD\u8BD5";let o=document.getElementById(e);o&&o.appendChild(r)}}function mt(){let e=document.querySelectorAll(".preset-checkbox:checked");return Array.from(e).map(t=>t.getAttribute("data-id"))}document.addEventListener("DOMContentLoaded",Er);var ht,A,yt,j,gt,D,W,V,ye,ge;function Er(){L(),ht=document.getElementById("compressForm"),A=document.getElementById("fontFile"),yt=document.getElementById("textInput"),j=document.getElementById("submitBtn"),gt=document.getElementById("fileSizeWarning"),D=document.getElementById("resultModal"),W=document.getElementById("resultLink"),V=document.getElementById("copyLink"),ye=document.getElementById("downloadFont"),ge=document.querySelector(".close"),ft("charset-container").catch(e=>{console.error("\u52A0\u8F7D\u5B57\u7B26\u96C6\u5931\u8D25:",e),w("\u52A0\u8F7D\u5B57\u7B26\u96C6\u5931\u8D25\uFF0C\u8BF7\u5237\u65B0\u9875\u9762\u91CD\u8BD5")}),_r(),xr()}function _r(){ht.addEventListener("submit",Cr),A.addEventListener("change",Sr),ge&&ge.addEventListener("click",()=>{D.style.display="none"}),V&&V.addEventListener("click",()=>{W.select(),document.execCommand("copy"),V.textContent="\u5DF2\u590D\u5236!",setTimeout(()=>{V.textContent="\u590D\u5236\u94FE\u63A5"},2e3)}),ye&&ye.addEventListener("click",()=>{W.value&&window.open(W.value,"_blank")}),window.addEventListener("click",e=>{e.target===D&&(D.style.display="none")}),window.addEventListener("message",e=>{try{let t=typeof e.data=="string"?JSON.parse(e.data):e.data;t.type==="font-compressed"&&t.downloadUrl&&we(t.downloadUrl,t.fontName,t.fileSize)}catch(t){console.error("\u5904\u7406postMessage\u65F6\u51FA\u9519:",t)}})}function xr(){let e=new URLSearchParams(window.location.search),t=e.get("fontUrl"),r=e.get("text"),o=e.get("charsets");if(t){let n=[];if(o){n=o.split(",").map(a=>a.trim()).filter(a=>a);let s=()=>{document.querySelectorAll(".preset-checkbox").length>0?n.forEach(a=>{let i=document.querySelector(`.preset-checkbox[data-id="${a}"]`);i&&(i.checked=!0)}):setTimeout(s,100)};s()}r||n.length>0?Tr(t,r||"",n):w("URL\u53C2\u6570\u4E2D\u7F3A\u5C11 text \u6216 charsets \u53C2\u6570")}}async function Tr(e,t,r=[]){w(""),j.disabled=!0,I(!0);try{let o={url:e,text:t,charsets:r};console.log("\u53D1\u9001\u5230\u538B\u7F29API\u7684\u6570\u636E (URL\u53C2\u6570\u8C03\u7528):",o),console.log("\u5F00\u59CB\u8C03\u7528\u5B57\u4F53\u538B\u7F29API...");let n=await fetch("/api/compress",{method:"POST",headers:{"Content-Type":"application/json","Cache-Control":"no-cache",Pragma:"no-cache"},body:JSON.stringify(o)});if(!n.ok){let a;try{a=await n.json()}catch{throw new Error(`\u538B\u7F29\u670D\u52A1\u9519\u8BEF: ${n.status} ${n.statusText}`)}throw new Error(a.error||`\u538B\u7F29\u670D\u52A1\u8FD4\u56DE\u9519\u8BEF: ${n.status}`)}let s=await n.json();if(s.success&&s.downloadUrl){if(Z("\u5B57\u4F53\u5DF2\u6210\u529F\u538B\u7F29\uFF01"),we(s.downloadUrl,s.fontName,s.fileSize),window.opener||window.parent!==window){let a={type:"font-compressed",downloadUrl:s.downloadUrl,fontName:s.fontName,fileSize:s.fileSize};window.opener?.postMessage(JSON.stringify(a),"*"),window.parent!==window&&window.parent.postMessage(JSON.stringify(a),"*")}}else throw new Error("\u538B\u7F29\u5931\u8D25\uFF0C\u672A\u8FD4\u56DE\u6709\u6548\u7684\u4E0B\u8F7DURL")}catch(o){console.error("\u8FDC\u7A0B\u5B57\u4F53\u5904\u7406\u8FC7\u7A0B\u4E2D\u51FA\u9519:",o),w(o.message||"\u5904\u7406\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u63A7\u5236\u53F0\u83B7\u53D6\u66F4\u591A\u4FE1\u606F\uFF0C\u6216\u7A0D\u540E\u91CD\u8BD5")}finally{j.disabled=!1,I(!1)}}function we(e,t,r){D&&W&&Te(e,t,r)}async function Cr(e){if(e.preventDefault(),w(""),!A.files[0]){w("\u8BF7\u9009\u62E9\u5B57\u4F53\u6587\u4EF6");return}let t=A.files[0],r=yt.value;if(!fe(t)){w("\u53EA\u652F\u6301TTF\u548COTF\u683C\u5F0F\u7684\u5B57\u4F53\u6587\u4EF6");return}j.disabled=!0,I(!0);try{console.log("\u5F00\u59CB\u4E0A\u4F20\u5B57\u4F53\u6587\u4EF6...");let o=await pt(t);if(Z("\u5B57\u4F53\u6587\u4EF6\u5DF2\u6210\u529F\u4E0A\u4F20\uFF0C\u6B63\u5728\u51C6\u5907\u538B\u7F29..."),!o.startsWith("http")){console.error("\u8B66\u544A: Blob URL\u683C\u5F0F\u5F02\u5E38\uFF0C\u7F3A\u5C11http\u524D\u7F00:",o),w("\u6587\u4EF6\u4E0A\u4F20\u8FD4\u56DE\u4E86\u65E0\u6548\u7684URL\u683C\u5F0F\uFF0C\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458");return}console.log("\u4E0A\u4F20\u6210\u529F\uFF0C\u83B7\u5F97Blob URL:",o);let n=mt(),s={url:o,text:r,charsets:n};console.log("\u53D1\u9001\u5230\u538B\u7F29API\u7684\u6570\u636E:",s),I(!0),C(0,!0),console.log("\u5F00\u59CB\u8C03\u7528\u538B\u7F29API...");let a=await fetch("/api/compress",{method:"POST",headers:{"Content-Type":"application/json","Cache-Control":"no-cache",Pragma:"no-cache"},body:JSON.stringify(s)});if(C(100),!a.ok){let l;try{l=await a.json()}catch{throw new Error(`\u538B\u7F29\u670D\u52A1\u9519\u8BEF: ${a.status} ${a.statusText}`)}throw new Error(l.error||`\u538B\u7F29\u670D\u52A1\u8FD4\u56DE\u9519\u8BEF: ${a.status}`)}let i=await a.json();if(i.success&&i.downloadUrl){let l={originalSize:(t.size/1024).toFixed(1),compressedSize:(i.fileSize/1024).toFixed(1),ratio:(100*(1-i.fileSize/t.size)).toFixed(1)};Z(`\u5B57\u4F53\u5DF2\u6210\u529F\u538B\u7F29\uFF01\u539F\u59CB\u5927\u5C0F: ${l.originalSize}KB, \u538B\u7F29\u540E: ${l.compressedSize}KB (\u538B\u7F29\u7387: ${l.ratio}%)`),(window.opener||window.parent!==window)&&Se(await(await fetch(i.downloadUrl)).blob(),i.fontName),we(i.downloadUrl,i.fontName,i.fileSize)}else throw new Error("\u538B\u7F29\u5931\u8D25\uFF0C\u672A\u8FD4\u56DE\u6709\u6548\u7684\u4E0B\u8F7DURL")}catch(o){console.error("\u5904\u7406\u8FC7\u7A0B\u4E2D\u51FA\u9519:",o);let n=o.message||"\u5904\u7406\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u63A7\u5236\u53F0\u83B7\u53D6\u66F4\u591A\u4FE1\u606F\uFF0C\u6216\u7A0D\u540E\u91CD\u8BD5",s=n.includes("\u8D85\u65F6")||n.includes("timeout")||n.includes("failed")||n.includes("\u5931\u8D25")||n.includes("\u9519\u8BEF")||n.includes("error");w(n,s)}finally{j.disabled=!1,I(!1),C(0,!1)}}function Sr(){if(A.files[0]){let e=A.files[0];gt.style.display="none",fe(e)?w(""):w("\u53EA\u652F\u6301TTF\u548COTF\u683C\u5F0F\u7684\u5B57\u4F53\u6587\u4EF6")}}
/*! Bundled license information:

is-buffer/index.js:
  (*!
   * Determine if an object is a Buffer
   *
   * @author   Feross Aboukhadijeh <https://feross.org>
   * @license  MIT
   *)

@vercel/blob/dist/chunk-HQEU7MYL.js:
  (*!
   * bytes
   * Copyright(c) 2012-2014 TJ Holowaychuk
   * Copyright(c) 2015 Jed Watson
   * MIT Licensed
   *)
*/
