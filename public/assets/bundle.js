var pt=Object.create;var he=Object.defineProperty;var ft=Object.getOwnPropertyDescriptor;var mt=Object.getOwnPropertyNames;var ht=Object.getPrototypeOf,yt=Object.prototype.hasOwnProperty;var I=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var gt=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of mt(t))!yt.call(e,n)&&n!==r&&he(e,n,{get:()=>t[n],enumerable:!(o=ft(t,n))||o.enumerable});return e};var j=(e,t,r)=>(r=e!=null?pt(ht(e)):{},gt(t||!e||!e.__esModule?he(r,"default",{value:e,enumerable:!0}):r,e));var Ce=I((_r,xe)=>{xe.exports=function(t){return t!=null&&t.constructor!=null&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)}});var Se=I((Er,Be)=>{function v(e,t){typeof t=="boolean"&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}Be.exports=v;v.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};v.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};v.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=new Date().getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.push(e),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var r=this._timeouts.shift();if(r===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1);else return!1;var o=this;return this._timer=setTimeout(function(){o._attempts++,o._operationTimeoutCb&&(o._timeout=setTimeout(function(){o._operationTimeoutCb(o._attempts)},o._operationTimeout),o._options.unref&&o._timeout.unref()),o._fn(o._attempts)},r),this._options.unref&&this._timer.unref(),!0};v.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};v.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)};v.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)};v.prototype.start=v.prototype.try;v.prototype.errors=function(){return this._errors};v.prototype.attempts=function(){return this._attempts};v.prototype.mainError=function(){if(this._errors.length===0)return null;for(var e={},t=null,r=0,o=0;o<this._errors.length;o++){var n=this._errors[o],s=n.message,a=(e[s]||0)+1;e[s]=a,a>=r&&(t=n,r=a)}return t}});var Ue=I(R=>{var wt=Se();R.operation=function(e){var t=R.timeouts(e);return new wt(t,{forever:e&&(e.forever||e.retries===1/0),unref:e&&e.unref,maxRetryTime:e&&e.maxRetryTime})};R.timeouts=function(e){if(e instanceof Array)return[].concat(e);var t={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var r in e)t[r]=e[r];if(t.minTimeout>t.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var o=[],n=0;n<t.retries;n++)o.push(this.createTimeout(n,t));return e&&e.forever&&!o.length&&o.push(this.createTimeout(n,t)),o.sort(function(s,a){return s-a}),o};R.createTimeout=function(e,t){var r=t.randomize?Math.random()+1:1,o=Math.round(r*Math.max(t.minTimeout,1)*Math.pow(t.factor,e));return o=Math.min(o,t.maxTimeout),o};R.wrap=function(e,t,r){if(t instanceof Array&&(r=t,t=null),!r){r=[];for(var o in e)typeof e[o]=="function"&&r.push(o)}for(var n=0;n<r.length;n++){var s=r[n],a=e[s];e[s]=function(l){var d=R.operation(t),u=Array.prototype.slice.call(arguments,1),f=u.pop();u.push(function(y){d.retry(y)||(y&&(arguments[0]=d.mainError()),f.apply(this,arguments))}),d.attempt(function(){l.apply(e,u)})}.bind(e,a),e[s].options=t}}});var Re=I((Cr,ke)=>{ke.exports=Ue()});var Ie=I((Br,Pe)=>{var vt=Re();function Tt(e,t){function r(o,n){var s=t||{},a;"randomize"in s||(s.randomize=!0),a=vt.operation(s);function i(u){n(u||new Error("Aborted"))}function l(u,f){if(u.bail){i(u);return}a.retry(u)?s.onRetry&&s.onRetry(u,f):n(a.mainError())}function d(u){var f;try{f=e(i,u)}catch(y){l(y,u);return}Promise.resolve(f).then(o).catch(function(m){l(m,u)})}a.attempt(d)}return new Promise(r)}Pe.exports=Tt});var re=I((Ur,Me)=>{function _t(e,t){if(typeof e!="function")throw new TypeError(`Expected the first argument to be a \`function\`, got \`${typeof e}\`.`);let r,o=0;return function(...s){clearTimeout(r);let a=Date.now(),i=a-o,l=t-i;l<=0?(o=a,e.apply(this,s)):r=setTimeout(()=>{o=Date.now(),e.apply(this,s)},l)}}Me.exports=_t});var bt={cn:"\u96F6\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D\u5341\u767E\u5343\u4E07\u4EBF",an:"0123456789",el:"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",cp:`\uFF01\uFF1F\u3002\uFF0C\u3001\uFF1B\uFF1A'""\uFF08\uFF09\u3010\u3011\u300A\u300B\u2026\u2014\uFF5E\xB7`,ep:"!?,.:;+-=_*&^%$#@<>/\\|",cc:"\u6625\u590F\u79CB\u51AC\u4E1C\u5357\u897F\u5317\u5929\u5730\u4EBA\u4F60\u6211\u4ED6\u662F\u4E0D\u4E86\u5728\u6709\u548C\u5C31\u8981\u8FD9\u4E00\u4E86\u6211\u4E0D\u4EBA\u5728\u4ED6\u6709\u4E3A\u8FD9\u4E2A\u4E0A\u4EEC\u6765\u5230\u65F6\u5927\u5730\u4E3A\u5B50\u4E2D\u4F60\u8BF4\u751F\u56FD\u5E74\u7740\u5C31\u90A3\u548C\u8981\u5979\u51FA\u4E5F\u5F97\u91CC\u540E\u81EA\u4EE5\u4F1A\u5BB6\u53EF\u4E0B\u800C\u8FC7\u5929\u53BB\u80FD\u5BF9\u5C0F\u591A\u7136\u4E8E\u5FC3\u5B66\u4E48\u4E4B\u90FD\u597D\u770B\u8D77\u53D1\u5F53\u6CA1\u6210\u53EA\u5982\u4E8B\u628A\u8FD8\u7528\u7B2C\u6837\u9053\u60F3\u4F5C\u79CD\u5F00\u7F8E\u603B\u4ECE\u65E0\u60C5\u5DF1\u9762\u6700\u5973\u4F46\u73B0\u524D\u4E9B\u6240\u540C\u65E5\u624B\u53C8\u884C\u610F\u52A8\u65B9\u671F\u5B83\u5934\u7ECF\u957F\u513F\u56DE\u4F4D\u5206\u7231\u8001\u56E0\u5F88\u7ED9\u540D\u6CD5\u95F4\u65AF\u77E5\u4E16\u4EC0\u4E24\u6B21\u4F7F\u8EAB\u8005\u88AB\u9AD8\u5DF2\u4EB2\u5176\u8FDB\u6B64\u8BDD\u5E38\u4E0E\u6D3B\u6B63\u611F\u89C1\u660E\u95EE\u529B\u7406\u5C14\u70B9\u6587\u51E0\u5B9A\u672C\u516C\u7279\u505A\u5916\u5B69\u76F8\u897F\u679C\u8D70\u5C06\u6708\u5341\u5B9E\u5411\u58F0\u8F66\u5168\u4FE1\u91CD\u4E09\u673A\u5DE5\u7269\u6C14\u6BCF\u5E76\u522B\u771F\u6253\u592A\u65B0\u6BD4\u624D\u4FBF\u592B\u518D\u4E66\u90E8\u6C34\u50CF\u773C\u7B49\u624D\u66F4\u5173\u5E94\u8868\u6027\u6C14\u4F60\u4E3B\u9898\u547D\u7ED9\u5236\u5EA6\u53D8\u6D77\u4E1A\u5373\u753B\u8BBE\u53CA\u7BA1\u4EAC\u8272\u5F3A\u5B57\u533B\u5EFA\u8C13\u4F55\u5E7F\u7EAA\u51B5\u5373\u7EC4\u7CBE\u6539\u8F83\u6B21\u522B\u4F4F\u8BC1\u8FD1\u5931\u8001\u6B65\u65AD\u5E26\u4F55\u57CE\u76F8\u4E66\u53F7\u987B\u636E\u7CFB\u79D1\u96C6\u4E14\u89C2\u8F6C\u4EC0\u5C71\u91D1\u8D44\u6D4E\u767D\u9700\u682A\u987B\u94C1\u65E0\u6C27"};function ye(e,t){let r=e,o=!1;return t.forEach(n=>{let s=bt[n];if(s){let a=Array.from(s).filter(i=>!r.includes(i));a.length>0&&(r+=a.join(""),o=!0)}}),{text:r,hasNewChars:o}}var c={errorMessage:null,successMessage:null,loading:null,uploadProgress:null,progressBarFill:null,progressText:null,modalContainer:null,modalContent:null,modalClose:null};function M(){c={errorMessage:document.getElementById("errorMessage"),successMessage:document.getElementById("successMessage"),loading:document.getElementById("loading"),uploadProgress:document.getElementById("uploadProgress"),progressBarFill:document.getElementById("progressBarFill"),progressText:document.getElementById("progressText")},k(c.errorMessage),k(c.successMessage),k(c.loading),k(c.uploadProgress),ge()}function ge(){if(document.getElementById("errorModal")){c.modalContainer=document.getElementById("errorModal"),c.modalContent=document.getElementById("errorModalContent"),c.modalClose=document.getElementById("errorModalClose");return}let e=document.createElement("div");e.id="errorModal",e.className="modal",e.style.display="none",e.style.position="fixed",e.style.zIndex="1000",e.style.left="0",e.style.top="0",e.style.width="100%",e.style.height="100%",e.style.backgroundColor="rgba(0,0,0,0.4)",e.style.overflow="auto";let t=document.createElement("div");t.id="errorModalContent",t.className="modal-content",t.style.backgroundColor="#fefefe",t.style.margin="15% auto",t.style.padding="20px",t.style.border="1px solid #888",t.style.borderRadius="5px",t.style.width="80%",t.style.maxWidth="500px",t.style.boxShadow="0 4px 8px 0 rgba(0,0,0,0.2)";let r=document.createElement("span");r.id="errorModalClose",r.className="close",r.innerHTML="&times;",r.style.color="#aaa",r.style.float="right",r.style.fontSize="28px",r.style.fontWeight="bold",r.style.cursor="pointer",r.onclick=()=>{e.style.display="none"},t.appendChild(r),e.appendChild(t),document.body.appendChild(e),window.onclick=function(o){o.target===e&&(e.style.display="none")},c.modalContainer=e,c.modalContent=t,c.modalClose=r}function x(e,t=!1){c.errorMessage||M(),c.errorMessage.textContent=e,G(c.errorMessage),k(c.successMessage),console.error("[ERROR]",e),t&&e&&be(e,"error")}function te(e,t=!1){c.successMessage||M(),c.successMessage.textContent=e,G(c.successMessage),k(c.errorMessage),console.log("[SUCCESS]",e),t&&e&&be(e,"success")}function be(e,t="error"){for(c.modalContainer||ge();c.modalContent.childElementCount>1;)c.modalContent.removeChild(c.modalContent.lastChild);let r=document.createElement("h3");r.textContent=t==="error"?"\u9519\u8BEF":"\u6210\u529F",r.style.color=t==="error"?"#e74c3c":"#27ae60",r.style.marginTop="0";let o=document.createElement("p");o.textContent=e,o.style.margin="10px 0";let n=document.createElement("button");n.textContent="\u786E\u5B9A",n.style.padding="8px 16px",n.style.backgroundColor=t==="error"?"#e74c3c":"#27ae60",n.style.color="white",n.style.border="none",n.style.borderRadius="4px",n.style.cursor="pointer",n.style.float="right",n.onclick=()=>{c.modalContainer.style.display="none"},c.modalContent.appendChild(r),c.modalContent.appendChild(o),c.modalContent.appendChild(n),c.modalContainer.style.display="block"}function J(e){c.loading||M(),e?G(c.loading):k(c.loading)}function we(e,t=!0){e&&(e.style.display=t?"block":"none")}function G(e){we(e,!0)}function k(e){we(e,!1)}function E(e,t=!0){if(c.uploadProgress||M(),t)G(c.uploadProgress);else{k(c.uploadProgress);return}let r=Math.max(0,Math.min(100,e));c.progressBarFill.style.width=`${r}%`,c.progressText.textContent=`${Math.round(r)}%`,r>=100?c.progressBarFill.style.backgroundColor="#27ae60":c.progressBarFill.style.backgroundColor="#3498db"}function ve(e,t){let r=window.URL.createObjectURL(e),o=document.createElement("a");o.href=r,o.download=t,document.body.appendChild(o),o.click(),setTimeout(()=>{document.body.removeChild(o),window.URL.revokeObjectURL(r)},100)}function Te(e,t="compressed-font.ttf"){if(!e)return t;let r=e.match(/filename="?([^"]*)"?/);return r&&r[1]?r[1]:t}function _e(){if(typeof navigator<"u"&&navigator.product==="ReactNative")return!0;if(typeof process<"u"){let e=process.type;return e==="renderer"||e==="worker"?!1:!!(process.versions&&process.versions.node)}return!1}var Ee={toWeb(){throw new Error("Vercel Blob: Sorry, we cannot get a Readable stream in this environment. If you see this message please open an issue here: https://github.com/vercel/storage/ with details on your environment.")}};var Ve=j(Ce(),1),Ge=j(Ie(),1);var N=globalThis.fetch.bind(globalThis);var tt=j(re(),1),nt=j(re(),1),Et=new Promise(e=>{try{let t=new Uint8Array([104,101,108,108,111]);new Blob([t]).text().then(o=>{e(o==="hello")}).catch(()=>{e(!1)})}catch{e(!1)}});async function De(e){if(e instanceof ReadableStream)return e;if(e instanceof Blob)return e.stream();if(ze(e))return Ee.toWeb(e);let t;return e instanceof ArrayBuffer?t=new Uint8Array(e):Ct(e)?t=e:t=xt(e),await Et?new Blob([t]).stream():new ReadableStream({start(r){r.enqueue(t),r.close()}})}function ze(e){return typeof e=="object"&&typeof e.pipe=="function"&&e.readable&&typeof e._read=="function"&&typeof e._readableState=="object"}function xt(e){return new TextEncoder().encode(e)}function Ct(e){return(0,Ve.default)(e)}var Bt=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i,St={b:1,kb:1024,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)};function T(e){if(typeof e=="number"&&!isNaN(e))return e;if(typeof e!="string")return null;let t=Bt.exec(e),r,o="b";if(!t)r=parseInt(e,10);else{let[,n,,,s]=t;if(!n)return null;r=parseFloat(n),s&&(o=s.toLowerCase())}return isNaN(r)?null:Math.floor(St[o]*r)}function Xe(e){if(e?.token)return e.token;if(process.env.BLOB_READ_WRITE_TOKEN)return process.env.BLOB_READ_WRITE_TOKEN;throw new p("No token found. Either configure the `BLOB_READ_WRITE_TOKEN` environment variable, or pass a `token` option to your calls.")}var p=class extends Error{constructor(e){super(`Vercel Blob: ${e}`)}};function ae(e){if(typeof e!="object"||e===null)return!1;let t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}var Ut=["//"],We=(()=>{if(_e())return!0;if(oe().startsWith("http://localhost"))return!1;let t=!1,r=new Request(oe(),{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!r})();function oe(e=""){let t=null;try{t=process.env.VERCEL_BLOB_API_URL||process.env.NEXT_PUBLIC_VERCEL_BLOB_API_URL}catch{}return`${t||"https://blob.vercel-storage.com"}${e}`}var Ae=typeof TextEncoder=="function"?new TextEncoder:null;function je(e){return e?typeof e=="string"?Ae?Ae.encode(e).byteLength:new Blob([e]).size:"byteLength"in e&&typeof e.byteLength=="number"?e.byteLength:"size"in e&&typeof e.size=="number"?e.size:0:0}var kt=(e,t)=>{let r=new Uint8Array(0);return new TransformStream({transform(o,n){queueMicrotask(()=>{let s=new Uint8Array(r.length+o.byteLength);for(s.set(r),s.set(new Uint8Array(o),r.length),r=s;r.length>=e;){let a=r.slice(0,e);n.enqueue(a),t?.(a.byteLength),r=r.slice(e)}})},flush(o){queueMicrotask(()=>{r.length>0&&(o.enqueue(r),t?.(r.byteLength))})}})};function Je(e){return globalThis.ReadableStream&&e instanceof ReadableStream}function Rt(e){return!!(Je(e)||ze(e))}var Pt=Object.prototype.toString,It=e=>Pt.call(e)==="[object Error]",Mt=new Set(["network error","Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Load failed","Network request failed","fetch failed","terminated"]);function At(e){return e&&It(e)&&e.name==="TypeError"&&typeof e.message=="string"?e.message==="Load failed"?e.stack===void 0:Mt.has(e.message):!1}var Ke=!1,Le,Oe;try{((Le=process.env.DEBUG)!=null&&Le.includes("blob")||(Oe=process.env.NEXT_PUBLIC_DEBUG)!=null&&Oe.includes("blob"))&&(Ke=!0)}catch{}function b(e,...t){Ke&&console.debug(`vercel-blob: ${e}`,...t)}var Ye=typeof N=="function",Lt=Ye&&We,Ot=64*1024,Ne=async({input:e,init:t,onUploadProgress:r})=>{b("using fetch");let o;if(t.body)if(r){let s=await De(t.body),a=0,i=kt(Ot,l=>{a+=l,r(a)});o=s.pipeThrough(i)}else o=t.body;let n=We&&o&&Rt(o)?"half":void 0;return N(e,{...t,...t.body?{body:o}:{},duplex:n})},Fe=typeof XMLHttpRequest<"u",$e=async({input:e,init:t,onUploadProgress:r})=>{b("using xhr");let o=null;return t.body&&(Je(t.body)?o=await new Response(t.body).blob():o=t.body),new Promise((n,s)=>{let a=new XMLHttpRequest;if(a.open(t.method||"GET",e.toString(),!0),r&&a.upload.addEventListener("progress",i=>{i.lengthComputable&&r(i.loaded)}),a.onload=()=>{var i;if((i=t.signal)!=null&&i.aborted){s(new DOMException("The user aborted the request.","AbortError"));return}let l=new Headers;a.getAllResponseHeaders().trim().split(/[\r\n]+/).forEach(f=>{let y=f.split(": "),m=y.shift(),w=y.join(": ");m&&l.set(m.toLowerCase(),w)});let u=new Response(a.response,{status:a.status,statusText:a.statusText,headers:l});n(u)},a.onerror=()=>{s(new TypeError("Network request failed"))},a.ontimeout=()=>{s(new TypeError("Network request timed out"))},a.onabort=()=>{s(new DOMException("The user aborted a request.","AbortError"))},t.headers&&new Headers(t.headers).forEach((l,d)=>{a.setRequestHeader(d,l)}),t.signal&&(t.signal.addEventListener("abort",()=>{a.abort()}),t.signal.aborted)){a.abort();return}a.send(o)})},Nt=async({input:e,init:t,onUploadProgress:r})=>{if(r){if(Lt)return Ne({input:e,init:t,onUploadProgress:r});if(Fe)return $e({input:e,init:t,onUploadProgress:r})}if(Ye)return Ne({input:e,init:t});if(Fe)return $e({input:e,init:t});throw new Error("No request implementation available")},He,Ft=(He=globalThis.DOMException)!=null?He:(()=>{try{atob("~")}catch(e){return Object.getPrototypeOf(e).constructor}})(),qe=950,$t=class extends p{constructor(){super("Access denied, please provide a valid token for this resource.")}},Ht=class extends p{constructor(e){super(`Content type mismatch, ${e}.`)}},qt=class extends p{constructor(e){super(`Pathname mismatch, ${e}. Check the pathname used in upload() or put() matches the one from the client token.`)}},Vt=class extends p{constructor(){super("Client token has expired.")}},Dt=class extends p{constructor(e){super(`File is too large, ${e}.`)}},zt=class extends p{constructor(){super("This store does not exist.")}},Xt=class extends p{constructor(){super("This store has been suspended.")}},Ze=class extends p{constructor(){super("Unknown error, please visit https://vercel.com/help.")}},Wt=class extends p{constructor(){super("The requested blob does not exist")}},Y=class extends p{constructor(){super("The blob service is currently not available. Please try again.")}},jt=class extends p{constructor(e){super(`Too many requests please lower the number of concurrent requests ${e?` - try again in ${e} seconds`:""}.`),this.retryAfter=e??0}},Jt=class extends p{constructor(){super("The request was aborted.")}},Gt=10;function Kt(){let e=null;try{e=process.env.VERCEL_BLOB_API_VERSION_OVERRIDE||process.env.NEXT_PUBLIC_VERCEL_BLOB_API_VERSION_OVERRIDE}catch{}return`${e??Gt}`}function Yt(){try{let e=process.env.VERCEL_BLOB_RETRIES||"10";return parseInt(e,10)}catch{return 10}}function Zt(e){let t=e.headers.get("retry-after");return new jt(t?parseInt(t,10):void 0)}async function Qt(e){var t,r,o;let n,s;try{let i=await e.json();n=(r=(t=i.error)==null?void 0:t.code)!=null?r:"unknown_error",s=(o=i.error)==null?void 0:o.message}catch{n="unknown_error"}s?.includes("contentType")&&s.includes("is not allowed")&&(n="content_type_not_allowed"),s?.includes('"pathname"')&&s.includes("does not match the token payload")&&(n="client_token_pathname_mismatch"),s==="Token expired"&&(n="client_token_expired"),s?.includes("the file length cannot be greater than")&&(n="file_too_large");let a;switch(n){case"store_suspended":a=new Xt;break;case"forbidden":a=new $t;break;case"content_type_not_allowed":a=new Ht(s);break;case"client_token_pathname_mismatch":a=new qt(s);break;case"client_token_expired":a=new Vt;break;case"file_too_large":a=new Dt(s);break;case"not_found":a=new Wt;break;case"store_not_found":a=new zt;break;case"bad_request":a=new p(s??"Bad request");break;case"service_unavailable":a=new Y;break;case"rate_limited":a=Zt(e);break;case"unknown_error":case"not_allowed":default:a=new Ze;break}return{code:n,error:a}}async function Z(e,t,r){let o=Kt(),n=Xe(r),s=er(),[,,,a=""]=n.split("_"),i=`${a}:${Date.now()}:${Math.random().toString(16).slice(2)}`,l=0,d=0,u=0,f=r?.onUploadProgress||tr();t.body&&f&&(d=je(t.body)),r?.onUploadProgress&&r.onUploadProgress({loaded:0,total:d,percentage:0});let y=await(0,Ge.default)(async m=>{let w;try{w=await Nt({input:oe(e),init:{...t,headers:{"x-api-blob-request-id":i,"x-api-blob-request-attempt":String(l),"x-api-version":o,...f?{"x-content-length":String(d)}:{},authorization:`Bearer ${n}`,...s,...t.headers}},onUploadProgress:r?.onUploadProgress?g=>{var L;let B=d!==0?d:g;u=g;let S=d>0?Number((g/B*100).toFixed(2)):0;S===100&&d>0||(L=r.onUploadProgress)==null||L.call(r,{loaded:g,total:B,percentage:S})}:void 0})}catch(g){if(g instanceof Ft&&g.name==="AbortError"){m(new Jt);return}if(At(g))throw g;if(g instanceof TypeError){m(g);return}throw g}if(w.ok)return w;let{code:P,error:C}=await Qt(w);if(P==="unknown_error"||P==="service_unavailable"||P==="internal_server_error")throw C;m(C)},{retries:Yt(),onRetry:m=>{m instanceof Error&&b(`retrying API request to ${e}`,m.message),l=l+1}});if(!y)throw new Ze;return r?.onUploadProgress&&r.onUploadProgress({loaded:u,total:u,percentage:100}),await y.json()}function er(){let e={};try{"VERCEL_BLOB_PROXY_THROUGH_ALTERNATIVE_API"in process.env&&process.env.VERCEL_BLOB_PROXY_THROUGH_ALTERNATIVE_API!==void 0?e["x-proxy-through-alternative-api"]=process.env.VERCEL_BLOB_PROXY_THROUGH_ALTERNATIVE_API:"NEXT_PUBLIC_VERCEL_BLOB_PROXY_THROUGH_ALTERNATIVE_API"in process.env&&process.env.NEXT_PUBLIC_VERCEL_BLOB_PROXY_THROUGH_ALTERNATIVE_API!==void 0&&(e["x-proxy-through-alternative-api"]=process.env.NEXT_PUBLIC_VERCEL_BLOB_PROXY_THROUGH_ALTERNATIVE_API)}catch{}return e}function tr(){try{return process.env.VERCEL_BLOB_USE_X_CONTENT_LENGTH==="1"}catch{return!1}}var K={cacheControlMaxAge:"x-cache-control-max-age",addRandomSuffix:"x-add-random-suffix",allowOverwrite:"x-allow-overwrite",contentType:"x-content-type"};function $(e,t){let r={};return e.includes("contentType")&&t.contentType&&(r[K.contentType]=t.contentType),e.includes("addRandomSuffix")&&t.addRandomSuffix!==void 0&&(r[K.addRandomSuffix]=t.addRandomSuffix?"1":"0"),e.includes("allowOverwrite")&&t.allowOverwrite!==void 0&&(r[K.allowOverwrite]=t.allowOverwrite?"1":"0"),e.includes("cacheControlMaxAge")&&t.cacheControlMaxAge!==void 0&&(r[K.cacheControlMaxAge]=t.cacheControlMaxAge.toString()),r}async function H({pathname:e,options:t,extraChecks:r,getToken:o}){if(!e)throw new p("pathname is required");if(e.length>qe)throw new p(`pathname is too long, maximum length is ${qe}`);for(let n of Ut)if(e.includes(n))throw new p(`pathname cannot contain "${n}", please encode it if needed`);if(!t)throw new p("missing options, see usage");if(t.access!=="public")throw new p('access must be "public"');return r&&r(t),o&&(t.token=await o(e,t)),t}function Qe({allowedOptions:e,getToken:t,extraChecks:r}){return async(o,n,s)=>{let a=await H({pathname:o,options:s,extraChecks:r,getToken:t}),i=$(e,a);return se({uploadId:a.uploadId,key:a.key,pathname:o,headers:i,options:a,parts:n})}}async function se({uploadId:e,key:t,pathname:r,parts:o,headers:n,options:s}){let a=new URLSearchParams({pathname:r});try{let i=await Z(`/mpu?${a.toString()}`,{method:"POST",headers:{...n,"content-type":"application/json","x-mpu-action":"complete","x-mpu-upload-id":e,"x-mpu-key":encodeURIComponent(t)},body:JSON.stringify(o),signal:s.abortSignal},s);return b("mpu: complete",i),i}catch(i){throw i instanceof TypeError&&(i.message==="Failed to fetch"||i.message==="fetch failed")?new Y:i}}function et({allowedOptions:e,getToken:t,extraChecks:r}){return async(o,n)=>{let s=await H({pathname:o,options:n,extraChecks:r,getToken:t}),a=$(e,s),i=await ie(o,a,s);return{key:i.key,uploadId:i.uploadId}}}async function ie(e,t,r){b("mpu: create","pathname:",e);let o=new URLSearchParams({pathname:e});try{let n=await Z(`/mpu?${o.toString()}`,{method:"POST",headers:{...t,"x-mpu-action":"create"},signal:r.abortSignal},r);return b("mpu: create",n),n}catch(n){throw n instanceof TypeError&&(n.message==="Failed to fetch"||n.message==="fetch failed")?new Y:n}}function rt({allowedOptions:e,getToken:t,extraChecks:r}){return async(o,n,s)=>{let a=await H({pathname:o,options:s,extraChecks:r,getToken:t}),i=$(e,a);if(ae(n))throw new p("Body must be a string, buffer or stream. You sent a plain JavaScript object, double check what you're trying to upload.");return{etag:(await le({uploadId:a.uploadId,key:a.key,pathname:o,part:{blob:n,partNumber:a.partNumber},headers:i,options:a})).etag,partNumber:a.partNumber}}}async function le({uploadId:e,key:t,pathname:r,headers:o,options:n,internalAbortController:s=new AbortController,part:a}){var i,l,d;let u=new URLSearchParams({pathname:r}),f=Z(`/mpu?${u.toString()}`,{signal:s.signal,method:"POST",headers:{...o,"x-mpu-action":"upload","x-mpu-key":encodeURIComponent(t),"x-mpu-upload-id":e,"x-mpu-part-number":a.partNumber.toString()},body:a.blob},n);function y(){s.abort()}(i=n.abortSignal)!=null&&i.aborted?y():(l=n.abortSignal)==null||l.addEventListener("abort",y);let m=await f;return(d=n.abortSignal)==null||d.removeEventListener("abort",y),m}var ot=typeof window<"u"?6:8,ne=8*1024*1024,F=ot*ne*2;function rr({uploadId:e,key:t,pathname:r,stream:o,headers:n,options:s,totalToLoad:a}){b("mpu: upload init","key:",t);let i=new AbortController;return new Promise((l,d)=>{let u=[],f=[],y=o.getReader(),m=0,w=!1,P=1,C=!1,g=0,L=!1,B=0,S=[],D=0,Q,fe={};s.onUploadProgress&&(Q=(0,tt.default)(()=>{var h;let _=Object.values(fe).reduce((X,W)=>X+W,0),U=a||_,O=a>0?Number(((_/a||_)*100).toFixed(2)):0;(h=s.onUploadProgress)==null||h.call(s,{loaded:_,total:U,percentage:O})},150)),me().catch(z);async function me(){for(b("mpu: upload read start","activeUploads:",m,"currentBytesInMemory:",`${T(g)}/${T(F)}`,"bytesSent:",T(B)),w=!0;g<F&&!C;)try{let{value:h,done:_}=await y.read();if(_){L=!0,b("mpu: upload read consumed the whole stream"),S.length>0&&(u.push({partNumber:P++,blob:new Blob(S,{type:"application/octet-stream"})}),ee()),w=!1;return}g+=h.byteLength;let U=0;for(;U<h.byteLength;){let O=ne-D,X=Math.min(U+O,h.byteLength),W=h.slice(U,X);S.push(W),D+=W.byteLength,U=X,D===ne&&(u.push({partNumber:P++,blob:new Blob(S,{type:"application/octet-stream"})}),S=[],D=0,ee())}}catch(h){z(h)}b("mpu: upload read end","activeUploads:",m,"currentBytesInMemory:",`${T(g)}/${T(F)}`,"bytesSent:",T(B)),w=!1}async function dt(h){m++,b("mpu: upload send part start","partNumber:",h.partNumber,"size:",h.blob.size,"activeUploads:",m,"currentBytesInMemory:",`${T(g)}/${T(F)}`,"bytesSent:",T(B));try{let _=s.onUploadProgress?O=>{fe[h.partNumber]=O.loaded,Q&&Q()}:void 0,U=await le({uploadId:e,key:t,pathname:r,headers:n,options:{...s,onUploadProgress:_},internalAbortController:i,part:h});if(b("mpu: upload send part end","partNumber:",h.partNumber,"activeUploads",m,"currentBytesInMemory:",`${T(g)}/${T(F)}`,"bytesSent:",T(B)),C)return;if(f.push({partNumber:h.partNumber,etag:U.etag}),g-=h.blob.size,m--,B+=h.blob.size,u.length>0&&ee(),L){m===0&&(y.releaseLock(),l(f));return}w||me().catch(z)}catch(_){z(_)}}function ee(){if(!C)for(b("send parts","activeUploads",m,"partsToUpload",u.length);m<ot&&u.length>0;){let h=u.shift();h&&dt(h)}}function z(h){C||(C=!0,i.abort(),y.releaseLock(),h instanceof TypeError&&(h.message==="Failed to fetch"||h.message==="fetch failed")?d(new Y):d(h))}})}async function or(e,t,r,o){b("mpu: init","pathname:",e,"headers:",r);let n={...o,onUploadProgress:void 0},s=await ie(e,r,n),a=je(t),i=await De(t),l=await rr({uploadId:s.uploadId,key:s.key,pathname:e,stream:i,headers:r,options:o,totalToLoad:a});return await se({uploadId:s.uploadId,key:s.key,pathname:e,parts:l,headers:r,options:n})}function ce({allowedOptions:e,getToken:t,extraChecks:r}){return async function(n,s,a){if(!s)throw new p("body is required");if(ae(s))throw new p("Body must be a string, buffer or stream. You sent a plain JavaScript object, double check what you're trying to upload.");let i=await H({pathname:n,options:a,extraChecks:r,getToken:t}),l=$(e,i);if(i.multipart===!0)return or(n,s,l,i);let d=i.onUploadProgress?(0,nt.default)(i.onUploadProgress,100):void 0,u=new URLSearchParams({pathname:n}),f=await Z(`/?${u.toString()}`,{method:"PUT",body:s,headers:l,signal:i.abortSignal},{...i,onUploadProgress:d});return{url:f.url,downloadUrl:f.downloadUrl,pathname:f.pathname,contentType:f.contentType,contentDisposition:f.contentDisposition}}}function at({allowedOptions:e,getToken:t,extraChecks:r}){return async(o,n)=>{let s=await H({pathname:o,options:n,extraChecks:r,getToken:t}),a=$(e,s),i=await ie(o,a,s);return{key:i.key,uploadId:i.uploadId,async uploadPart(l,d){if(ae(d))throw new p("Body must be a string, buffer or stream. You sent a plain JavaScript object, double check what you're trying to upload.");return{etag:(await le({uploadId:i.uploadId,key:i.key,pathname:o,part:{partNumber:l,blob:d},headers:a,options:s})).etag,partNumber:l}},async complete(l){return se({uploadId:i.uploadId,key:i.key,pathname:o,parts:l,headers:a,options:s})}}}}function q(e){return function(r){if(!r.token.startsWith("vercel_blob_client_"))throw new p(`${e} must be called with a client token`);if(r.addRandomSuffix!==void 0||r.allowOverwrite!==void 0||r.cacheControlMaxAge!==void 0)throw new p(`${e} doesn't allow \`addRandomSuffix\`, \`cacheControlMaxAge\` or \`allowOverwrite\`. Configure these options at the server side when generating client tokens.`)}}var Gr=ce({allowedOptions:["contentType"],extraChecks:q("client/`put`")}),Kr=et({allowedOptions:["contentType"],extraChecks:q("client/`createMultipartUpload`")}),Yr=at({allowedOptions:["contentType"],extraChecks:q("client/`createMultipartUpload`")}),Zr=rt({allowedOptions:["contentType"],extraChecks:q("client/`multipartUpload`")}),Qr=Qe({allowedOptions:["contentType"],extraChecks:q("client/`completeMultipartUpload`")}),st=ce({allowedOptions:["contentType"],extraChecks(e){if(e.handleUploadUrl===void 0)throw new p("client/`upload` requires the 'handleUploadUrl' parameter");if(e.addRandomSuffix!==void 0||e.createPutExtraChecks!==void 0||e.cacheControlMaxAge!==void 0)throw new p("client/`upload` doesn't allow `addRandomSuffix`, `cacheControlMaxAge` or `allowOverwrite`. Configure these options at the server side when generating client tokens.")},async getToken(e,t){var r,o;return ar({handleUploadUrl:t.handleUploadUrl,pathname:e,clientPayload:(r=t.clientPayload)!=null?r:null,multipart:(o=t.multipart)!=null?o:!1})}});var nr={generateClientToken:"blob.generate-client-token",uploadCompleted:"blob.upload-completed"};async function ar(e){let{handleUploadUrl:t,pathname:r}=e,o=ir(t)?t:sr(t),n={type:nr.generateClientToken,payload:{pathname:r,callbackUrl:o,clientPayload:e.clientPayload,multipart:e.multipart}},s=await N(o,{method:"POST",body:JSON.stringify(n),headers:{"content-type":"application/json"},signal:e.abortSignal});if(!s.ok)throw new p("Failed to  retrieve the client token");try{let{clientToken:a}=await s.json();return a}catch{throw new p("Failed to retrieve the client token")}}function sr(e){return new URL(e,location.href).href}function ir(e){try{return!!new URL(e)}catch{return!1}}var lr=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1";function lt(e,t=4.5){return e.size>t*1024*1024}function it(e,t,r="\u64CD\u4F5C\u8D85\u65F6"){let o,n=new Promise((s,a)=>{o=setTimeout(()=>{a(new Error(r))},t)});return Promise.race([e,n]).finally(()=>{clearTimeout(o)})}async function cr(e){console.log("\u4F7F\u7528\u76F4\u63A5\u4E0A\u4F20\u6A21\u5F0F...");let t=new FormData;t.append("fontFile",e);let r=await fetch("/api/direct-upload",{method:"POST",body:t});if(!r.ok){let n;try{throw n=await r.json(),new Error(n.error||`\u4E0A\u4F20\u5931\u8D25: ${r.status}`)}catch{throw new Error(`\u4E0A\u4F20\u5931\u8D25: ${r.status} ${r.statusText}`)}}return(await r.json()).fileUrl}async function ct(e){let t=null;try{E(0,!0),console.log(`\u5F00\u59CB\u4E0A\u4F20\u5B57\u4F53 ${e.name} \u5230 Blob Store...`),t=ur();let r=null;if(lr)try{console.log("\u672C\u5730\u5F00\u53D1\u73AF\u5883\uFF0C\u4F18\u5148\u5C1D\u8BD5\u76F4\u63A5\u4E0A\u4F20..."),r=await it(cr(e),3e4,"\u76F4\u63A5\u4E0A\u4F20\u5B57\u4F53\u6587\u4EF6\u8D85\u65F6\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u8FDE\u63A5\u6216\u5C1D\u8BD5\u8F83\u5C0F\u7684\u6587\u4EF6"),console.log("\u76F4\u63A5\u4E0A\u4F20\u6210\u529F\uFF0CURL:",r)}catch(o){console.warn("\u76F4\u63A5\u4E0A\u4F20\u5931\u8D25\uFF0C\u5C1D\u8BD5\u4F7F\u7528Vercel Blob\u4E0A\u4F20:",o)}if(!r){console.log("\u4F7F\u7528Vercel Blob\u4E0A\u4F20...");let o=st(e.name,e,{access:"public",handleUploadUrl:"/api/upload-font"});console.log("\u6B63\u5728\u7B49\u5F85\u4E0A\u4F20\u5B8C\u6210...");let n=await it(o,3e4,"\u4E0A\u4F20\u5B57\u4F53\u6587\u4EF6\u8D85\u65F6\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u8FDE\u63A5\u6216\u5C1D\u8BD5\u8F83\u5C0F\u7684\u6587\u4EF6");if(!n||!n.url)throw new Error("\u4E0A\u4F20\u6210\u529F\u4F46\u672A\u83B7\u5F97\u6709\u6548\u7684Blob URL");r=n.url,console.log("\u5B57\u4F53\u6210\u529F\u4E0A\u4F20\u5230 Blob Store:",n)}return t&&(clearInterval(t),t=null),E(100),r}catch(r){console.error("\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25:",r),t&&clearInterval(t),E(0,!1);let o="\u5B57\u4F53\u4E0A\u4F20\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u6216\u6587\u4EF6\u7C7B\u578B\uFF0C\u7136\u540E\u91CD\u8BD5\u3002";throw r.message&&(r.message.includes("timeout")||r.message.includes("\u8D85\u65F6")?o="\u4E0A\u4F20\u8D85\u65F6\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u8FDE\u63A5\u6216\u5C1D\u8BD5\u8F83\u5C0F\u7684\u6587\u4EF6":r.message.includes("network")||r.message.includes("\u7F51\u7EDC")?o="\u7F51\u7EDC\u9519\u8BEF\uFF0C\u8BF7\u68C0\u67E5\u60A8\u7684\u4E92\u8054\u7F51\u8FDE\u63A5\u5E76\u91CD\u8BD5":o=r.message),x(o+" (\u8BE6\u7EC6\u4FE1\u606F\u89C1\u63A7\u5236\u53F0)",!0),new Error(o)}}function ur(){let e=0,t=95;return setInterval(()=>{if(e<t){let r=Math.max(.5,(t-e)/15);e+=r,E(Math.min(e,t))}},150)}function ue(e,t=["font/ttf","font/otf","application/octet-stream","application/vnd.ms-opentype"]){return t.includes(e.type)||/\.(ttf|otf)$/i.test(e.name)}document.addEventListener("DOMContentLoaded",dr);var ut,A,V,de,pe;function dr(){M(),ut=document.getElementById("compressForm"),A=document.getElementById("fontFile"),V=document.getElementById("textInput"),de=document.getElementById("submitBtn"),pe=document.getElementById("fileSizeWarning"),pr()}function pr(){ut.addEventListener("submit",fr),A.addEventListener("change",hr),document.getElementById("addSelectedChars").addEventListener("click",yr)}async function fr(e){if(e.preventDefault(),x(""),!A.files[0]){x("\u8BF7\u9009\u62E9\u5B57\u4F53\u6587\u4EF6");return}let t=A.files[0],r=V.value;if(!ue(t)){x("\u53EA\u652F\u6301TTF\u548COTF\u683C\u5F0F\u7684\u5B57\u4F53\u6587\u4EF6");return}de.disabled=!0,J(!0);let o=null,n=null;try{console.log("\u5F00\u59CB\u4E0A\u4F20\u5B57\u4F53\u6587\u4EF6...");let s=await ct(t);te("\u5B57\u4F53\u6587\u4EF6\u5DF2\u6210\u529F\u4E0A\u4F20\u5230Blob Store\uFF0C\u6B63\u5728\u51C6\u5907\u538B\u7F29...");let a={blobUrl:s,text:r};console.log("\u53D1\u9001\u5230\u538B\u7F29API\u7684\u6570\u636E:",a),J(!0),E(0,!0),o=mr(),n=new AbortController;let i=setTimeout(()=>{n&&(n.abort(),console.error("\u538B\u7F29\u8BF7\u6C42\u8D85\u65F6\uFF0C\u5DF2\u4E2D\u65AD"))},45e3);console.log("\u5F00\u59CB\u8C03\u7528\u538B\u7F29API...");try{let l=await fetch("/api/compress",{method:"POST",headers:{"Content-Type":"application/json","Cache-Control":"no-cache",Pragma:"no-cache"},body:JSON.stringify(a),signal:n.signal});if(clearTimeout(i),o&&(clearInterval(o),o=null),E(100),!l.ok){let m;try{m=await l.json()}catch{throw new Error(`\u538B\u7F29\u670D\u52A1\u9519\u8BEF: ${l.status} ${l.statusText}`)}throw new Error(m.error||`\u538B\u7F29\u670D\u52A1\u8FD4\u56DE\u9519\u8BEF: ${l.status}`)}let d=l.headers.get("content-disposition"),u=Te(d)||"compressed-font.ttf";console.log("\u5F00\u59CB\u4E0B\u8F7D\u538B\u7F29\u540E\u7684\u5B57\u4F53\u6587\u4EF6...");let f=await l.blob();ve(f,u);let y={originalSize:(t.size/1024).toFixed(1),compressedSize:(f.size/1024).toFixed(1),ratio:(100*(1-f.size/t.size)).toFixed(1)};te(`\u5B57\u4F53\u5DF2\u6210\u529F\u538B\u7F29\u5E76\u4E0B\u8F7D\uFF01\u539F\u59CB\u5927\u5C0F: ${y.originalSize}KB, \u538B\u7F29\u540E: ${y.compressedSize}KB (\u538B\u7F29\u7387: ${y.ratio}%)`)}catch(l){throw l.name==="AbortError"?new Error("\u538B\u7F29\u8BF7\u6C42\u8D85\u65F6\uFF0C\u8BF7\u5C1D\u8BD5\u51CF\u5C11\u5B57\u7B26\u6570\u91CF\u6216\u4F7F\u7528\u8F83\u5C0F\u7684\u5B57\u4F53\u6587\u4EF6"):l}}catch(s){console.error("\u5904\u7406\u8FC7\u7A0B\u4E2D\u51FA\u9519:",s);let a=s.message||"\u5904\u7406\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u63A7\u5236\u53F0\u83B7\u53D6\u66F4\u591A\u4FE1\u606F\uFF0C\u6216\u7A0D\u540E\u91CD\u8BD5",i=a.includes("\u8D85\u65F6")||a.includes("timeout")||a.includes("failed")||a.includes("\u5931\u8D25")||a.includes("\u9519\u8BEF")||a.includes("error");x(a,i)}finally{o&&clearInterval(o),n&&(n=null),de.disabled=!1,J(!1),E(0,!1)}}function mr(){let e=0,t=95;return setInterval(()=>{if(e<t){let r=Math.max(.5,(t-e)/10);e+=r,E(Math.min(e,t))}},200)}function hr(){if(A.files[0]){let e=A.files[0];lt(e)?pe.style.display="block":pe.style.display="none",ue(e)?x(""):x("\u53EA\u652F\u6301TTF\u548COTF\u683C\u5F0F\u7684\u5B57\u4F53\u6587\u4EF6")}}function yr(){let e=Array.from(document.querySelectorAll(".preset-checkbox:checked")).map(r=>r.getAttribute("data-id"));if(e.length===0)return;let t=ye(V.value,e);if(t.hasNewChars){V.value=t.text,V.focus();let r=document.getElementById("addSelectedChars");r.textContent="\u5DF2\u6DFB\u52A0\u2713",r.disabled=!0,setTimeout(()=>{r.textContent="\u6DFB\u52A0\u6240\u9009\u5B57\u7B26\u96C6",r.disabled=!1},1e3)}document.querySelectorAll(".preset-checkbox:checked").forEach(r=>{r.checked=!1})}
/*! Bundled license information:

is-buffer/index.js:
  (*!
   * Determine if an object is a Buffer
   *
   * @author   Feross Aboukhadijeh <https://feross.org>
   * @license  MIT
   *)

@vercel/blob/dist/chunk-HQEU7MYL.js:
  (*!
   * bytes
   * Copyright(c) 2012-2014 TJ Holowaychuk
   * Copyright(c) 2015 Jed Watson
   * MIT Licensed
   *)
*/
